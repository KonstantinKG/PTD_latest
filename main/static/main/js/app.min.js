(()=>{"use strict";(()=>{const e=new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.target.classList.toggle("_animate",e.isIntersecting),e.isIntersecting&&t.unobserve(e.target)}))}),{threshold:.2}),t=document.querySelectorAll("._anim-item");t.length>0&&t.forEach((t=>{e.observe(t)}));const n=new IntersectionObserver(((e,t)=>{e.forEach((e=>{e.target.classList.toggle("_animate",e.isIntersecting),e.isIntersecting&&t.unobserve(e.target)}))}),{threshold:0}),o=document.querySelectorAll("._table-item");o.length>0&&o.forEach((e=>{n.observe(e)}));const r=document.querySelector(".cookie"),i=document.querySelector(".cookie__button");if(r){setTimeout((()=>{r.style.removeProperty("opacity"),r.style.removeProperty("visibility")}),3e3),i.addEventListener("click",(()=>{document.cookie="CookieBy=PtatinumDragons; max-age=2592000",document.cookie&&r.classList.add("_hide")})),-1!=document.cookie.indexOf("CookieBy=PtatinumDragons")?r.classList.add("_hide"):r.classList.remove("_hide");const qe=document.querySelector(".cookie__message"),Ee=document.querySelector(".cookie__link"),we=document.querySelector(".cookie__buttons"),ke=window.matchMedia("(max-width: 767px)");function xe(e){e.matches?Ee.classList.contains("_adapt")||(we.append(Ee),Ee.classList.add("_adapt")):Ee.classList.contains("_adapt")&&(qe.append(Ee),Ee.classList.remove("_adapt"))}ke.addEventListener("change",xe),xe(ke)}!function(e){let t=new Image;t.onload=t.onerror=function(){!function(e){let t=!0===e?"webp":"no-webp";document.documentElement.classList.add(t)}(2==t.height)},t.src="data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA"}(),function(){let e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`),window.addEventListener("resize",(()=>{let e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`)}))}(),function(){const e=document.querySelector(".edit-profile__item input"),t=document.querySelector(".edit-profile__preview");e&&e.addEventListener("change",(()=>{!function(n){if(!["image/jpg","image/jpeg","image/png","image/webp"].includes(n.type))return alert("Разрешены только изображения"),void(e.value="");if(n.size>52428800)return void alert("Файл должен быть менее 50мб");let o=new FileReader;o.onload=e=>{t.innerHTML=`<img src="${e.target.result}" alt="Фото">`},o.onerror=e=>{alert("Ошибка")},o.readAsDataURL(n)}(e.files[0])}))}();const s=document.querySelector(".icon-header"),l=document.querySelector(".header__top"),a=document.querySelector(".menu");s&&s.addEventListener("click",(()=>{s.classList.contains("active")?s.classList.add("reverse"):s.classList.remove("reverse"),document.body.classList.toggle("burger-lock"),s.classList.toggle("active"),l.classList.toggle("active"),a.classList.toggle("active")}));const c=document.querySelector(".menu__list"),d=window.matchMedia("(max-width: 1024px)");function u(e){e.matches?c.lastElementChild.hasAttribute("data-chat")||c.insertAdjacentHTML("beforeend",'<li data-chat=""><a href="chat.html" class="menu__link">Чат</a></li>'):c.lastElementChild.hasAttribute("data-chat")&&c.lastElementChild.remove()}c&&(d.addEventListener("change",u),u(d));const p=document.querySelector(".aside__arrows"),m=document.querySelectorAll(".aside-open");if(p){function Ae(){for(let e=0;e<m.length;e++){const t=m[e];t&&t.classList.toggle("active")}}p.addEventListener("click",Ae)}const y=document.querySelectorAll(".popup__tab"),v=document.querySelectorAll(".popup__form");y.length>0&&function(e,t){for(let n=0;n<e.length;n++){const o=e[n];o.addEventListener("click",(()=>{const n=o.getAttribute("data-tab");for(let o=0;o<e.length;o++)n===t[o].getAttribute("data-tab-content")?(e[o].classList.add("active"),t[o].classList.add("active")):(e[o].classList.remove("active"),t[o].classList.remove("active"))}))}}(y,v);const f=document.getElementsByTagName("input");f.length>0&&h(f);const _=document.getElementsByTagName("textarea");function h(e){for(let t=0;t<e.length;t++){const n=e[t],o=n.placeholder;n.addEventListener("focus",(function(e){n.placeholder="",n.classList.remove("_error")})),n.addEventListener("blur",(function(e){n.placeholder=o}))}}_.length>0&&h(_);const g=document.querySelector(".profile__wins i"),L=document.querySelector(".profile__trophies"),b=document.querySelector(".profile__image img");g&&(g.addEventListener("mouseover",(()=>{L.classList.add("_show"),g.previousElementSibling.classList.add("_stop"),b.classList.add("_show")})),g.addEventListener("mouseout",(()=>{L.classList.remove("_show"),g.previousElementSibling.classList.remove("_stop"),b.classList.remove("_show")}))),document.querySelector(".error")&&setTimeout((()=>{window.location.replace(history.back())}),5e3);const S=document.querySelectorAll(".popup-link"),q=document.querySelector("body"),E=document.querySelectorAll(".lock-padding");let w=!0;if(S.length>0)for(let Te=0;Te<S.length;Te++){const Pe=S[Te];Pe.addEventListener("click",(function(e){const t=Pe.getAttribute("href").replace("#","");x(document.getElementById(t)),e.preventDefault()}))}const k=document.querySelectorAll(".close-popup");if(k.length>0)for(let De=0;De<k.length;De++){const $e=k[De];$e.addEventListener("click",(function(e){A($e.closest(".popup")),e.preventDefault()}))}function x(e){if(e&&w){const t=document.querySelector(".popup.open");t?A(t,!1):function(){const e=window.innerWidth-document.querySelector(".wrapper").offsetWidth+"px";if(E.length>0)for(let t=0;t<E.length;t++)E[t].style.paddingRight=e;q.style.paddingRight=e,q.classList.add("lock"),w=!1,setTimeout((function(){w=!0}),800)}(),e.classList.add("open"),e.addEventListener("click",(function(e){e.target.closest(".popup__content")||A(e.target.closest(".popup"))}))}}function A(e,t=!0){e.closest(".popup._sending")||w&&(e.classList.remove("open"),t&&(setTimeout((function(){if(E.length>0)for(let e=0;e<E.length;e++)E[e].style.paddingRight="0px";q.style.paddingRight="0px",q.classList.remove("lock")}),800),w=!1,setTimeout((function(){w=!0}),800)))}document.addEventListener("keydown",(function(e){"Escape"===e.key&&A(document.querySelector(".popup.open"))})),new Swiper(".about-swiper",{loop:!0,grabCursor:!0,initialSlide:3,speed:800,pagination:{el:".swiper-pagination",clickable:!0,dynamicBullets:!0},autoplay:{delay:3500,stopOnLastSlide:!1,disableOnInteraction:!1},mousewheel:{sensitivity:1,eventsTarget:".about-swiper"},keyboard:{enabled:!0,onlyInViewport:!0,pageUpDown:!0},preloadImages:!1,lazy:{loadOnTransitionStart:!0,loadPrevNext:!0}});let T,P=document.querySelector(".icon-chat");P&&document.addEventListener("scroll",(function(){P.style.opacity=1,P.style.visibility="visible",P.style.transform="translate(0,0)",null!=T&&clearTimeout(T),T=setTimeout((()=>{P.style.opacity=0,P.style.visibility="hidden",P.style.transform="translate(0,100%)"}),2500)}));const D=document.querySelector(".chat__content");D&&I(D);const $=document.querySelector(".chat__scroll-button");$&&R($,D);const O=document.querySelector(".chat-aside__content");O&&I(O);const H=document.querySelector(".chat-aside__scroll-button");function I(e){e.scrollTo(0,e.scrollHeight)}function R(e,t){const n=t.scrollTop-100;t.addEventListener("scroll",(()=>{t.scrollTop<=n?(e.style.opacity=1,e.style.visibility="visible",e.style.transform="translate(0,0)"):(e.style.opacity=0,e.style.visibility="hidden",e.style.transform="translate(0,150%)")})),e.addEventListener("click",(()=>{t.scrollTo({top:t.scrollHeight,behavior:"smooth"})}))}H&&R(H,O);const C=document.querySelector(".chat__header");C&&C.addEventListener("click",(()=>{history.back()}));const B=document.querySelector(".chat-aside__body.blocked");B&&B.insertAdjacentHTML("afterbegin",'<div class="icon-blocked _icon-block"></div>\n\t\t<h3 class="title-blocked">Вы не вошли в аккаунт</h3>');const M=document.querySelector(".list-players__input-searh"),X=document.querySelectorAll(".search-label"),N=document.querySelector(".search-alert"),j=document.querySelector(".list-players__items");if(M){M.addEventListener("input",He);const Oe=document.querySelector(".list-players__reset");function He(){let e=M.value.toLowerCase().trim(),t=0;e?(Oe.style.opacity="1",Oe.style.visibility="visible"):(Oe.style.opacity=0,Oe.style.visibility="hidden");for(let n=0;n<X.length;n++){const o=X[n];o.innerHTML.toLowerCase().includes(e)?o.closest(".list-players__item").hidden=!1:(o.closest(".list-players__item").hidden=!0,t++)}t==X.length?(N.textContent="Нет совпадений",N.classList.add("_show")):(N.textContent="",N.classList.remove("_show")),t>=1?j.classList.add("_active"):j.classList.remove("_active")}Oe.addEventListener("click",(()=>{M.focus(),M.value="",He()}))}document.addEventListener("DOMContentLoaded",(function(){const e=document.querySelector(".info-tournament__button"),t=document.querySelector(".info-tournament__description"),n=document.querySelector(".info-tournament__img");e&&(setTimeout((()=>{e.classList.toggle("active"),t.classList.toggle("active")}),500),e.addEventListener("click",(o=>{e.classList.toggle("active"),t.classList.toggle("active"),n.classList.add("disabled"),e.classList.contains("active")||setTimeout((()=>{n.classList.remove("disabled")}),800)})));const o=document.querySelector(".tour-table__body");if(!o)return;let r=document.querySelector("#data"),i=JSON.parse(JSON.parse(r.innerHTML));r.remove();let s=window.matchMedia("(min-width: 1025px)");s.addEventListener("change",(()=>{s.matches?O():(a.removeEventListener("pointerdown",C),a.removeEventListener("pointerup",B),a.removeEventListener("pointermove",M),a.removeEventListener("wheel",I),k.removeEventListener("click",H),document.querySelector(".wrapper").removeEventListener("pointermove",R))}));let l,a,c,d,u,p,m,y,v=1,f=!1,_=0,h=0,g={x:0,y:0};const L=i.stages,b=new Array,S=document.querySelector(".edit__btn"),q=document.querySelector(".edit__save"),E=document.querySelector(".edit__tips"),w=document.querySelector(".table-scale__text"),k=document.querySelector(".table-scale__reset");function x(){o.innerHTML="";for(let e in L){const t=L[e];b[e]=new Array;let n=document.createElement("div");n.className="tour-table__column",n.style=L.length-1==e?`--p:${2**(e-1)};`:`--p:${2**e};`,n.insertAdjacentHTML("afterbegin",A(e));for(let o in t){const r=t[o];let i,s=document.createElement("div");s.className="tour-table__para",s.setAttribute("data-pos",$(e,o)),L.length-2==e&&o>0&&s.classList.add("extra"),L.length-1==e?(i=T(r),s.classList.add("final")):i=P(r,e,o),s.insertAdjacentHTML("beforeend",i),b[e][o]=D(s,e,o),n.append(s)}o.append(n)}O()}function A(e){let t;return t=L.length-1==e?"Финал":L.length-2==e?"Полуфинал":"Этап "+(+e+1),`\n         <div class="tour-table__stage stage">\n            <div class="stage__title">${t}</div>\n         </div>\n      `}function T(e){return`\n         <div class="tour-table__player player player-final first">\n               <div class="player__info"> \n                  <div class="player__name">${e.first}</div>\n               </div>\n         </div>\n         <div class="tour-table__player player player-final second">\n               <div class="player__info">\n                  <div class="player__name">${e.second}</div>\n               </div>\n         </div>\n         <div class="tour-table__player player player-final third">\n               <div class="player__info">\n                  <div class="player__name">${e.third}</div>\n               </div>\n         </div>\n      `}function P(e,t,n){let o,r=e.score.split(","),i="",s="",l='\n         <div class="bars bars__first">\n            <div class="bars bars__second">\n               <div class="bars bars__last"></div>\n            </div>\n         </div>\n      ';return e.player1&&(i=`<div class="player__name">${e.player1}</div><input type="text" disabled class="player__score" name="edit" value="${r[0]}">`),e.player2&&(s=`<div class="player__name">${e.player2}</div><input type="text" disabled class="player__score" name="edit" value="${r[1]}">`),L.length-2==t&&(l='<div class="bars bars__staight"></div>'),o=`\n         <div class="tour-table__player player member1" id="${t}${n}1">\n            <div class="player__info">${i}</div>\n         </div>\n         <div class="tour-table__player player member2" id="${t}${n}2"> \n            <div class="player__info">${s}</div>\n         </div>\n         ${l}\n      `,o}function D(e,t,n){let o={},r=new Array;return t<=0?{self:e,next:r}:([b[t-1][2*n]||b[t-1][2*n-2],b[t-1][2*n+1]||b[t-1][2*n-1]].forEach((t=>{t.next.push(e)})),o={self:e,next:r},o)}function $(e,t){let n,o;return n=t%2==0,o=L.length-1==t,`${e},${t},${n},${o}`}function O(){s.matches&&(s.matches&&(a=document.getElementById("zoom"),c=a.parentElement.clientHeight,d=a.parentElement.clientWidth,u=a.scrollHeight,p=a.scrollWidth),a.addEventListener("pointerdown",C),a.addEventListener("pointerup",B),a.addEventListener("pointermove",M),a.addEventListener("wheel",I),k.addEventListener("click",H),document.querySelector(".wrapper").addEventListener("pointermove",R),N())}function H(){k.classList.remove("active"),v=1,f=!1,_=0,h=0,g={x:0,y:0},F(),N()}function I(e){if(e.ctrlKey){e.preventDefault(),X();let[t,n]=function(e){return[e.clientX-y,e.clientY-m]}(e),o=(t-_)/v,r=(n-h)/v,i=e.wheelDelta?e.wheelDelta:-e.deltaY;i>0?v*=1.2:v/=1.2,v>5&&(v=5),_=t-o*v,h=n-r*v,i<0&&(_>=0&&(_=0),h>=0&&(h=0)),v<=j&&(v=j),1!=j||v!=j?k.classList.add("active"):k.classList.remove("active"),N(),F()}}function R(e){X(),(e.clientX<y||e.clientY<m||e.clientX>y+d||e.clientY>m+c)&&(f=!1)}function C(e){g={x:e.clientX-_,y:e.clientY-h},f=!0}function B(){f=!1}function M(e){if(!f)return;let t=e.clientX-g.x,n=e.clientY-g.y;_=t<l.xmax?l.xmax:t>0?0:t,h=n<l.ymax?l.ymax:n>0?0:n,F()}function X(){m=a.parentNode.getBoundingClientRect().top,y=a.parentNode.getBoundingClientRect().left}function N(){let e=-(p*v-d),t=-(u*v-c);t>-10&&(t=0),e>-10&&(e=0),l={xmax:e,ymax:t}}x();const j=function(){let e=Math.floor(d/p*100)/100,t=Math.floor(window.innerHeight/u*100)/100;return e>1&&(e=1),t>1&&(t=1),e>=t?e:t}();function F(){a.style.transform="translate("+_+"px, "+h+"px) scale("+v+")",w.innerText=~~(v/1*100)+"%"}let W,Y,z,J,U=1,V=[],G=!0,K=[];function Q(){W=document.querySelectorAll(".player__score");for(let e=0;e<W.length;e++){const t=W[e];t.removeAttribute("disabled"),t.classList.add("_edit")}s.matches&&(W[0].focus(),W[0].setSelectionRange(W[0].value.length,W[0].value.length))}function Z(e){if("Enter"==e.key){let e=W[U],t=e.value.length;e.focus(),e.setSelectionRange(t,t),U++}"Tab"==e.key&&U++,U>W.length-1&&(U=0)}function ee(e){let t=e.target.closest(".tour-table__para");if(!o.classList.contains("_block"))if(t){let e=t.getAttribute("data-pos").split(",");if(t.classList.contains("_cause"))return;ie(V),ne(e,V),t.classList.add("_cause"),Y=t}else ie(V)}function te(e){let t=e.target,n=t.closest(".tour-table__player");if(t.classList.contains("player__score"))return W=document.querySelectorAll(".player__score"),void(U=function(e,t){for(let n=0;n<e.length;n++)if(t.isEqualNode(e[n].closest(".player")))return n;return!1}(W,n)+1||U);if(n){let e=n.closest(".tour-table__para").getAttribute("data-pos").split(",");if(o.classList.add("_block"),1==function(e){if(!G)return!1;for(const t of K)if(e.isEqualNode(t))return J=t,!0}(n))!function(e){G=!1;let t=re(z),n=re(J),r=z.cloneNode(!0);r.style.position="absolute",z.prepend(r),r.style.cssText+="\n         transition: all 0.5s ease 0s;\n         z-index: 120;\n      ";let i=(n.x-t.x)/v,s=(n.y-t.y)/v;setTimeout((()=>{z.classList.remove("_active"),z.style.boxShadow="inset 0px 0px 3px rgba(105, 105, 105, 0.65)",r.style.cssText+=`\n            position: absolute;\n            top: ${s}px;\n            left: ${i}px;\n            width: ${J.offsetWidth}px;\n            box-shadow: none;\n         `,r.classList.add("_pseudo"),J.innerHTML="",J.classList.remove("hover"),r.querySelector(".player__score").value="0"}),0),setTimeout((()=>{J.append(r.querySelector(".player__info")),J.classList.add("_changed"),r.remove(),G=!0,o.classList.remove("_block"),J.removeAttribute("style"),z.removeAttribute("style"),J.length=0,K.length=0}),1e3)}();else if(n.classList.contains("_active"))n.classList.remove("_active"),o.classList.remove("_block");else{if(""==n.querySelector(".player__info").innerHTML)return;ne(e,K),z&&z.classList.remove("_active"),n.classList.add("_active"),z=n}}}function ne(e,t){let n=b[e[0]][e[1]];ie(t),n.next.forEach((n=>{let o;if(n.classList.contains("final")){let o,r,i=n.querySelectorAll(".player"),s=i.length,l=2*e[1];if(l+1>s)return;return l+2>s&&(o=i[l],o.classList.add("hover"),t.push(o)),void(l+2<=s&&(o=i[l],o.classList.add("hover"),r=i[l+1],r.classList.add("hover"),t.push(o,r)))}"true"==e[2]?(o=n.querySelector(".member1"),o.classList.add("hover")):(o=n.querySelector(".member2"),o.classList.add("hover")),t.push(o)}))}function oe(e){let t=e.target.closest(".player");if(!t)return;let n=t.getAttribute("id");(!n||t&&!n.startsWith("0"))&&(t.querySelector(".player__info").innerHTML="",t.classList.add("_changed"),W=document.querySelectorAll(".player__score"),U--)}function re(e){let{top:t,left:n}=e.getBoundingClientRect();return{x:n,y:t}}function ie(e){Y&&Y.classList.remove("_cause"),0!=e.length&&(e.forEach((e=>{e.classList.remove("hover")})),e.length=0)}S&&S.addEventListener("click",(()=>{S.classList.toggle("active"),S.classList.contains("active")?(E.style.height=E.scrollHeight+"px",E.classList.add("active"),Q(),document.addEventListener("keydown",Z),o.addEventListener("pointerover",ee),o.addEventListener("click",te),o.addEventListener("dblclick",oe)):function(){E.classList.remove("active"),E.style.height="0px",W=document.querySelectorAll(".player__score");for(let e=0;e<W.length;e++){const t=W[e];t.setAttribute("disabled",""),t.classList.remove("_edit")}document.removeEventListener("keydown",Z),o.removeEventListener("pointerover",ee),o.removeEventListener("click",te),o.removeEventListener("dblclick",oe)}()})),q&&q.addEventListener("click",(function(e){let t=o.querySelectorAll("._changed");console.log("sending"),t.length<=0||!S.classList.contains("active")||(console.log("sending"),t.forEach((e=>{let t=e.closest(".tour-table__para").getAttribute("data-pos").split(","),n=L[+t[0]][+t[1]],o=n.score,r="",s="";if(""!=e.querySelector(".player__info").innerHTML&&(r=e.querySelector(".player__name").innerText,s=e.querySelector(".player__score").value),o&&(o=o.split(",")),e.classList.contains("first"))return n.first=r,void(i.first=r);if(e.classList.contains("second"))return n.second=r,void(i.second=r);if(e.classList.contains("third"))return n.third=r,void(i.third=r);let l=1;e.classList.contains("member2")&&(l=2),r!=n[`player${l}`]&&(n[`player${l}`]=r),s!=o[l-1]&&(o[l-1]=s,n.score=o.join(","))})),console.log("sending"),function(e,t){let n=t.getAttribute("data-url"),o=document.querySelector("#notifyPopup");fetch(n,{method:"POST",body:JSON.stringify({data:e}),headers:{"X-Requested-With":"XMLHttpRequest","X-CSRFToken":getCookie("csrftoken")}}).then((e=>{if(e.ok)return e.json()})).then((e=>{if(o&&"message"in e){o.querySelector(".popup__message p").innerText=e.message,x(o);let t=()=>{o.classList.contains("open")||(o.removeEventListener("click",t),window.location.reload())};o.addEventListener("click",t)}}))}(i,e.target),x(),Q())})),o&&o.addEventListener("change",(e=>{e.target.closest(".player").classList.add("_changed")}))}),!1);const F=document.querySelectorAll("[data-spollers]");if(F.length>0){const Ie=Array.from(F).filter((function(e,t,n){return!e.dataset.spollers.split(",")[0]}));Ie.length>0&&Ce(Ie);const Re=Array.from(F).filter((function(e,t,n){return e.dataset.spollers.split(",")[0]}));if(Re.length>0){const Ne=[];Re.forEach((e=>{const t={},n=e.dataset.spollers.split(",");t.value=n[0],t.type=n[1]?n[1].trim():"max",t.item=e,Ne.push(t)}));let je=Ne.map((function(e){return"("+e.type+"-width: "+e.value+"px),"+e.value+","+e.type}));je=je.filter((function(e,t,n){return n.indexOf(e)===t})),je.forEach((e=>{const t=e.split(","),n=t[1],o=t[2],r=window.matchMedia(t[0]),i=Ne.filter((function(e){if(e.value===n&&e.type===o)return!0}));r.addEventListener("change",(()=>{Ce(i,r)})),Ce(i,r)}))}function Ce(e,t=!1){e.forEach((e=>{e=t?e.item:e,t.matches||!t?(e.classList.add("_init"),Be(e),e.addEventListener("click",Me)):(e.classList.remove("_init"),Be(e,!1),e.removeEventListener("click",Me))}))}function Be(e,t=!0){const n=e.querySelectorAll("[data-spoller]");n.length>0&&n.forEach((e=>{t?(e.removeAttribute("tabindex"),e.classList.contains("_active")||(e.nextElementSibling.hidden=!0)):(e.setAttribute("tabindex","-1"),e.nextElementSibling.hidden=!1)}))}function Me(e){const t=e.target;if(t.hasAttribute("data-spoller")||t.closest("[data-spoller]")){const n=t.hasAttribute("data-spoller")?t:t.closest("[data-spoller]"),o=n.closest("[data-spollers]"),r=!!o.hasAttribute("data-one-spoller");o.querySelectorAll("._slide").length||(r&&!n.classList.contains("_active")&&Xe(o),n.classList.toggle("_active"),K(n.nextElementSibling,500)),e.preventDefault()}}function Xe(e){const t=e.querySelector("[data-spoller]._active");t&&(t.classList.remove("_active"),G(t.nextElementSibling,500))}}let W,Y,z,J,U,V,G=(e,t=500)=>{e.classList.contains("_slide")||(e.classList.add("_slide"),e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.height=e.offsetHeight+"px",e.style.transitionTimingFunction="ease",e.offsetHeight,e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,window.setTimeout((()=>{e.hidden=!0,e.style.removeProperty("height"),e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.style.removeProperty("transition-timing-function"),e.classList.remove("_slide")}),t))},K=(e,t=500)=>e.hidden?((e,t=500)=>{if(!e.classList.contains("_slide")){e.classList.add("_slide"),e.hidden&&(e.hidden=!1);let n=e.offsetHeight;e.style.overflow="hidden",e.style.height=0,e.style.paddingTop=0,e.style.paddingBottom=0,e.style.marginTop=0,e.style.marginBottom=0,e.offsetHeight,e.style.transitionProperty="height, margin, padding",e.style.transitionDuration=t+"ms",e.style.transitionTimingFunction="ease",e.style.height=n+"px",e.style.removeProperty("padding-top"),e.style.removeProperty("padding-bottom"),e.style.removeProperty("margin-top"),e.style.removeProperty("margin-bottom"),window.setTimeout((()=>{e.style.removeProperty("height"),e.style.removeProperty("overflow"),e.style.removeProperty("transition-duration"),e.style.removeProperty("transition-property"),e.style.removeProperty("transition-timing-function"),e.classList.remove("_slide")}),t)}})(e,t):G(e,t);const Q=document.querySelector(".login__form"),Z=document.querySelector(".register__form"),ee=document.querySelector(".reset-email__form"),te=document.querySelector(".resend-recovery-email-form"),ne=document.querySelector(".resend-activation-email-form"),oe=document.querySelector(".resend-activation-email-btn");function re(e={}){document.location.reload()}function ie(e={}){x(document.getElementById("notifyTimerActivationPopup"))}function se(e={}){x(document.getElementById("notifyTimerRecoveryPopup")),0!=Object.keys(e).length&&de(e,te)}Q&&Q.addEventListener("submit",(e=>{e.preventDefault(),Le(Q,re)})),Z&&Z.addEventListener("submit",(e=>{e.preventDefault(),Le(Z,ie)})),ee&&ee.addEventListener("submit",(e=>{e.preventDefault(),Le(ee,se)}));const le=document.querySelector(".new-password__form");function ae(e={}){x(document.getElementById("mainPopup"))}function ce(e={}){0!=Object.keys(e).length&&de(e)}function de(e,t=NaN,n=!0){let o=e.data;if(t=t||e.form,"resend"in o){let e=o.resend;if(t.querySelector(".popup__error").innerText=e.error,+e.tries<=0)return t.querySelector(".tries").innerText="0",void(t.querySelector(".timer").innerText="0:00");n?(J=e.timer,U=e.tries):(z=e.timer,V=e.tries);let r=t.querySelector(".timer");t.querySelector(".tries").innerText=n?U:V,function(e,t=!0){let n=setInterval((()=>{t?J>0?(e.innerText=ue(J),J--):(e.innerText="0:00",J=0,clearInterval(n)):z>0?(e.innerText=ue(z),z--):(e.innerText="0:00",clearInterval(n))}),1e3);t?Y=n:W=n}(r,n)}}function ue(e){return e%60<10?`${~~(e/60)}:0${e%60}`:`${~~(e/60)}:${e%60}`}le&&le.addEventListener("submit",(e=>{e.preventDefault(),Le(le,ae)})),ne&&(ne.addEventListener("submit",(e=>{e.preventDefault();let t=ne.querySelector(".popup__error");if(!z&&!V)return t.innerText="",void Le(ne,ce);z<=0&&V>0?(t.innerText="",Le(ne,ce)):t.innerText=z>0?"Отправка сообщения будет доступна по истечению таймера":"Вы привысили лимит попыток попробуйте через 3 часа"})),oe.addEventListener("click",(e=>{e.preventDefault(),Le(ne,ce)}))),te&&te.addEventListener("submit",(e=>{e.preventDefault();let t=te.querySelector(".popup__error");if(!J&&!U)return t.innerText="",void Le(te,ce);J<=0&&U>0?(t.innerText="",Le(te,ce)):t.innerText=J>0?"Отправка сообщения будет доступна по истечению таймера":"Вы привысили лимит попыток попробуйте через 3 часа"}));const pe=document.querySelector(".edit-profile__form");pe&&pe.addEventListener("submit",(e=>{e.preventDefault();let t=pe.querySelector(".edit-profile__input-file"),n=pe.getAttribute("action"),o=new FormData(pe);t&&t.files.length>0&&o.append("photo",t.files[0]),fetch(n,{method:"POST",body:o}).then((e=>(e.redirected&&window.location.replace(e.url),e.ok?e.json():(be(pe,{server:"500"}),!1)))).then((e=>{e&&"errors"in e&&be(pe,e.errors)}))}));const me=document.querySelector(".players__form");me&&me.addEventListener("submit",(e=>{e.preventDefault();let t=me.getAttribute("action"),n=me.querySelectorAll("input[name=players]:checked"),o=new Array,r=new FormData(me);n.forEach((e=>{o.push(e.value)})),r.append("players",o),fetch(t,{method:"POST",body:r}).then((e=>(e.redirected&&window.location.replace(e.url),e.ok?e.json():(be(pe,{server:"500"}),!1)))).then((e=>{e&&"errors"in e&&be(pe,e.errors)}))}));const ye=document.getElementById("editTeamName");ye&&ye.addEventListener("change",(e=>{e.preventDefault();let t=ye.getAttribute("data-url"),n=new FormData;n.append("name",ye.value),ye.classList.add("_loading"),ye.classList.remove("_error"),fetch(t,{method:"POST",body:n,headers:{"X-Requested-With":"XMLHttpRequest","X-CSRFToken":Se("csrftoken")}}).then((e=>{if(e.ok)return e.json()})).then((e=>{e&&"errors"in e?(ye.value="",ye.classList.add("_error"),ye.setAttribute("placeholder",e.errors[ye.name])):(ye.classList.remove("_loading"),ye.classList.add("_loaded"))}))}));const ve=document.querySelector(".list-players__add");if(ve){const Fe=ve.closest("form");Fe.addEventListener("submit",(e=>{e.preventDefault();let t=Fe.getAttribute("action"),n=Fe.querySelectorAll("input[name=invite]:checked");if(n.length>0){let e=new Array,o=new FormData(Fe);n.forEach((t=>{e.push(t.value)})),o.append("invite",e),fetch(t,{method:"POST",body:o}).then((e=>{let t=document.getElementById("notifyPopup");e.ok?(t.querySelector(".popup__message p").innerText="Приглашения успешно разосланы",n.forEach((e=>{e.closest(".list-players__item").remove()}))):t.querySelector(".popup__message p").innerText="На сервере произошла ошибка. Не получилось отправить приглашения",x(t)}))}}))}const fe=document.querySelector(".list-players__del");if(fe){const We=fe.closest("form");We.addEventListener("submit",(e=>{e.preventDefault();let t=We.getAttribute("action"),n=We.querySelectorAll("input[name=delete]:checked");if(n.length>0){let e=new Array,o=new FormData(We);n.forEach((t=>{e.push(t.value)})),o.append("delete",e),fetch(t,{method:"POST",body:o}).then((e=>{let t=document.getElementById("notifyPopup");e.ok?(t.querySelector(".popup__message p").innerText="Игроки успешно удалены из команды",n.forEach((e=>{e.closest(".list-players__item").remove()}))):t.querySelector(".popup__message p").innerText="На сервере произошла ошибка. Не получилось удалить участников команды.",x(t)}))}}))}const _e=document.querySelectorAll("._invitation");function he(e){let t=e.target,n=t.closest(".tables__btns").querySelector(".invite_id").value;if(t.classList.contains("_icon-check")||t.classList.contains("tables__btn_close")){let e=t.getAttribute("data-url"),o=new FormData;o.append("invite_id",n),t.classList.contains("tables__btn_close")&&t.closest(".tables__item").remove(),fetch(e,{method:"POST",body:o,headers:{"X-Requested-With":"XMLHttpRequest","X-CSRFToken":Se("csrftoken")}}).then((e=>{if(e.ok){if(t.classList.contains("tables__btn_close"))return;window.location.reload()}else{let e=document.getElementById("notifyPopup");e.querySelector(".popup__message p").innerText="На сервере произошла ошибка. Не получилось обработать запрос. Попробуйте снова.",x(e)}}))}}_e.length>0&&_e.forEach((e=>{e.addEventListener("click",he)}));let ge=document.querySelector(".info-tournament__form");if(ge){ge.addEventListener("submit",(e=>{if(13==e.code)return void e.preventDefault();let t=ge.querySelector(".info-tournament__form-button");if(t.classList.contains("_authorize"))return e.preventDefault(),void x(document.querySelector("#mainPopup"));if(!t.classList.contains("disabled")||t.classList.contains("_unroll")){e.preventDefault();let n=new FormData(ge),o=ge.querySelector('input[name="typo"]').value,r="1"==o?void 0:ge.querySelectorAll("input[name=players]:checked"),i=ge.getAttribute("action"),s="";if(t.classList.contains("_unroll")){let e=document.querySelector("#confirmLeaveTournamentPopup");return x(e),s=Ye.bind(void 0,i,n,e),void e.querySelector(".popup__btn-agree").addEventListener("click",s)}if(r&&0!=r.length&&r.length!=o)return void(ge.querySelector(".info-tournament__note").innerText="Вы выбрали неправильное кол-во игроков.");Ye(i,n)}else e.preventDefault()}));let Ye=(e,t,n)=>{n&&(n.querySelector(".popup__btn-agree").removeEventListener("click",cover),popupClose(n)),fetch(e,{method:"POST",body:t}).then((e=>{e.redirected&&window.location.replace(e.url),e.ok&&window.location.reload()}))}}function Le(e,t){let n=e.getAttribute("action"),o=function(e){let t={};for(let n of e.keys())t[n]=e.get(n);return t}(new FormData(e)),r=e.closest(".popup");r&&r.classList.add("_sending"),fetch(n,{method:"POST",credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRFToken":Se("csrftoken")},body:JSON.stringify(o)}).then((t=>(r&&r.classList.remove("_sending"),t.ok?t.json():(be(e,{server:"500"}),!1)))).then((n=>{n&&(console.log(n),"errors"in n?be(e,n.errors):t({data:n,form:e}))}))}function be(e,t){const n=e.querySelectorAll("input"),o=e.querySelector(".popup__error");if(n.forEach((e=>{e.name in t&&(e.setAttribute("placeholder",t[e.name]),e.classList.add("_error"),e.value="")})),o&&(o.innerText="","server"in t?o.innerText="На сервере произошла ошибка. Попробуйте отправить форму еще раз":"email_failed"in t&&(o.innerText=t.email_failed),"__all__"in t&&t.__all__.length>0)){if(t.__all__.includes("Эта учетная запись отключена."))return void e.querySelector(".popup__note").classList.add("_active");e.querySelector(".popup__note").classList.remove("_active"),o.innerText=t.__all__[0]}}function Se(e){let t=null;if(document.cookie&&""!==document.cookie){const n=document.cookie.split(";");for(let o=0;o<n.length;o++){const r=n[o].trim();if(r.substring(0,e.length+1)===e+"="){t=decodeURIComponent(r.substring(e.length+1));break}}}return t}})()})();